[37m[36mINFO[0m[0m 07/24 16:38:18 | Command :: train_smos.py train_PACS_on_Mario_algo_SMOS_JS_ld_KL_0.15_batchsize_16_seed_3 --data_dir /scratch/yluo97/data/dg/ --work_dir ./output/ --project_name SMOS_PACS_on_Mario --algorithm SMOS_JS --dataset PACS_on_Mario --ld_KL 0.15 --lr 3e-5 --steps 5001 --model_save 5000 --resnet_dropout 0.0 --weight_decay 0.0 --trial_seed 3 --seed 3 --batch_size 16 --checkpoint_freq 200 --miro_pretrained False --pretrained True --smos_pre_featurizer_pretrained True --smos_pre_featurizer_path ./precursor/SMD_PT_4800.pth
Environment:
	Python: 3.9.16
	PyTorch: 2.0.1
	Torchvision: 0.15.2
	CUDA: 11.7
	CUDNN: 8500
	NumPy: 1.23.5
	PIL: 9.4.0
Args:
	algorithm: SMOS_JS
	aug_type: None
	checkpoint_freq: 200
	configs: []
	data_dir: /scratch/yluo97/data/dg
	dataset: PACS_on_Mario
	debug: False
	deterministic: True
	downsample_size: None
	evalmode: fast
	holdout_fraction: 0.2
	model_save: 5000
	name: train_PACS_on_Mario_algo_SMOS_JS_ld_KL_0.15_batchsize_16_seed_3
	out_dir: output/train_output/PACS_on_Mario/SMOS_JS/240724_16-38-17_train_PACS_on_Mario_algo_SMOS_JS_ld_KL_0.15_batchsize_16_seed_3
	out_root: output/train_output/PACS_on_Mario
	prebuild_loader: False
	project_name: SMOS_PACS_on_Mario
	seed: 3
	show: False
	steps: 5001
	tb_freq: 10
	test_envs: None
	trial_seed: 3
	unique_name: 240724_16-38-17_train_PACS_on_Mario_algo_SMOS_JS_ld_KL_0.15_batchsize_16_seed_3
	work_dir: output
HParams:
	data_augmentation: True
	val_augment: False
	resnet18: False
	[36mresnet_dropout: 0.0
	[0mclass_balanced: False
	optimizer: adam
	freeze_bn: True
	[36mpretrained: True
	[0m[36mlr: 3e-05
	[0m[36mbatch_size: 16
	[0m[36mweight_decay: 0.0
	[0mswad: True
	swad_kwargs: 
	  n_converge: 3
	  n_tolerance: 6
	  tolerance_ratio: 0.3
	test_batchsize: 16
	model: resnet50
	feat_layers: stem_block
	ld: 0.15
	[36mld_KL: 0.15
	[0mlr_mult: 10.0
	[36mmiro_pretrained: False
	[0mmiro_pretrained_path: ./
	dg_pretrained: False
	dg_pretrained_path: ./
	[36msmos_pre_featurizer_pretrained: True
	[0m[36msmos_pre_featurizer_path: ./precursor/SMD_PT_4800.pth[0m
Dataset:
	[PACS_on_Mario] #envs=4, #classes=7
	env0: cartoon (#2344)
	env1: painting (#2048)
	env2: photo (#1670)
	env3: sketch (#3929)

[37m[36mINFO[0m[0m 07/24 16:38:18 | n_steps = 5001
[37m[36mINFO[0m[0m 07/24 16:38:18 | checkpoint_freq = 200
[37m[36mINFO[0m[0m 07/24 16:38:18 | n_steps is updated to 5001 => 5001 for checkpointing
[37m[36mINFO[0m[0m 07/24 16:38:18 | Target test envs = [[0], [1], [2], [3]]
[37m[36mINFO[0m[0m 07/24 16:38:18 | 
[37m[36mINFO[0m[0m 07/24 16:38:18 | Testenv name escaping te_cartoon -> te_cartoon
[37m[36mINFO[0m[0m 07/24 16:38:18 | Test envs = [0], name = te_cartoon
[37m[36mINFO[0m[0m 07/24 16:38:18 | Batch sizes for each domain: [0, 16, 16, 16] (total=48)
[37m[36mINFO[0m[0m 07/24 16:38:18 | steps-per-epoch for each domain: 102.44, 83.50, 196.50 -> min = 83.50
[37m[36mINFO[0m[0m 07/24 16:38:22 | # of params = 47034311
[37m[36mINFO[0m[0m 07/24 16:38:28 | test_in     test_out    train_in    train_out   tr_outloss  env0_in     env0_out    env1_out    env2_out    env3_out    step        epoch       loss        feat_loss   step_time   eval_time  
[37m[36mINFO[0m[0m 07/24 16:38:28 | 0.135394    0.134615    0.000000    0.180860    1.970890    0.135394    0.134615    0.158924    0.206587    0.177070    0           0.000000    1.924173    -0.445400   0.516199    6.255674   
[37m[36mINFO[0m[0m 07/24 16:38:54 | 0.716951    0.724359    0.000000    0.941514    0.170203    0.716951    0.724359    0.938875    0.985030    0.900637    200         2.395210    0.298843    -0.569776   0.087718    5.621978   
[37m[36mINFO[0m[0m 07/24 16:39:20 | 0.723881    0.737179    0.000000    0.947366    0.149453    0.723881    0.737179    0.936430    0.991018    0.914650    400         4.790419    0.025090    -0.514734   0.088443    5.589580   
[37m[36mINFO[0m[0m 07/24 16:39:47 | 0.741471    0.754274    0.000000    0.949272    0.151566    0.741471    0.754274    0.941320    0.988024    0.918471    600         7.185629    -0.027166   -0.522051   0.088818    5.589647   
[37m[36mINFO[0m[0m 07/24 16:40:13 | 0.802772    0.829060    0.000000    0.952417    0.135358    0.802772    0.829060    0.948655    0.985030    0.923567    800         9.580838    -0.041212   -0.521178   0.089351    5.519038   
[37m[36mINFO[0m[0m 07/24 16:40:39 | 0.811301    0.835470    0.000000    0.956456    0.121721    0.811301    0.835470    0.943765    0.988024    0.937580    1000        11.976048   -0.076779   -0.539169   0.088987    5.454313   
[37m[36mINFO[0m[0m 07/24 16:41:05 | 0.775053    0.790598    0.000000    0.964296    0.115205    0.775053    0.790598    0.970660    0.991018    0.931210    1200        14.371257   -0.093765   -0.552758   0.088633    5.761326   
[37m[36mINFO[0m[0m 07/24 16:41:31 | 0.748934    0.769231    0.000000    0.939436    0.188042    0.748934    0.769231    0.914425    0.979042    0.924841    1400        16.766467   -0.100879   -0.572863   0.088764    5.634992   
[37m[36mINFO[0m[0m 07/24 16:41:57 | 0.723348    0.741453    0.000000    0.943133    0.188602    0.723348    0.741453    0.921760    0.970060    0.937580    1600        19.161677   -0.102158   -0.583121   0.088700    5.635901   
[37m[36mINFO[0m[0m 07/24 16:42:23 | 0.721215    0.739316    0.000000    0.959109    0.135943    0.721215    0.739316    0.955990    0.985030    0.936306    1800        21.556886   -0.112907   -0.597750   0.088298    5.828696   
[37m[36mINFO[0m[0m 07/24 16:42:49 | 0.682836    0.688034    0.000000    0.942281    0.230103    0.682836    0.688034    0.914425    0.985030    0.927389    2000        23.952096   -0.115741   -0.613568   0.088135    5.735528   
[37m[36mINFO[0m[0m 07/24 16:43:16 | 0.769190    0.784188    0.000000    0.950866    0.173558    0.769190    0.784188    0.929095    0.991018    0.932484    2200        26.347305   -0.123414   -0.626710   0.088558    5.762921   
